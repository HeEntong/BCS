(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    114070,       2681]
NotebookOptionsPosition[    112844,       2655]
NotebookOutlinePosition[    113301,       2673]
CellTagsIndexPosition[    113258,       2670]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"<<", " ", "NC`"}], "\[IndentingNewLine]", 
 RowBox[{"<<", " ", "NCAlgebra`"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", " ", "NCGBX`"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PBVertices", " ", "=", " ", 
    RowBox[{"Range", "[", 
     RowBox[{"1", ",", " ", "7"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PBEdges", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"AppendTo", "[", 
    RowBox[{"PBEdges", ",", " ", 
     RowBox[{"i", " ", "<->", " ", 
      RowBox[{"i", " ", "+", " ", "1"}]}]}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"i", ",", " ", "1", ",", " ", "4"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AppendTo", "[", 
    RowBox[{"PBEdges", ",", " ", 
     RowBox[{"5", " ", "<->", " ", "1"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AppendTo", "[", 
      RowBox[{"PBEdges", ",", " ", 
       RowBox[{"6", " ", "<->", " ", "i"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"PBEdges", ",", " ", 
       RowBox[{"7", " ", "<->", " ", "i"}]}], "]"}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "1", ",", " ", "5"}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PB", " ", "=", " ", 
   RowBox[{"Graph", "[", 
    RowBox[{"PBVertices", ",", " ", "PBEdges"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adj", " ", "=", " ", 
    RowBox[{"AdjacencyMatrix", "[", "PB", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rels", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vars", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Subscript", "[", 
      RowBox[{"e", ",", " ", "i", ",", " ", "a"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "7"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"a", ",", " ", "1", ",", " ", "4"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"adj", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], " ", "==", " ", 
           "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"rels", ",", " ", 
            RowBox[{
             RowBox[{"vars", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", " ", "a"}], "]"}], "]"}], " ", "**", " ", 
             RowBox[{"vars", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", " ", "a"}], "]"}], "]"}]}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", "1", ",", " ", "7"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "1", ",", " ", "7"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"a", ",", " ", "1", ",", " ", "4"}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"a", " ", "!=", " ", "b"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"rels", ",", " ", 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", " ", "a"}], "]"}], "]"}], " ", "**", " ", 
              RowBox[{"vars", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", " ", "b"}], "]"}], "]"}]}]}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"b", ",", " ", "1", ",", " ", "4"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"a", ",", " ", "1", ",", " ", "4"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "1", ",", " ", "7"}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"rels", ",", " ", 
         RowBox[{
          RowBox[{"aj", "[", 
           RowBox[{"vars", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", " ", "a"}], "]"}], "]"}], "]"}], " ", "-", " ", 
          RowBox[{"vars", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", " ", "a"}], "]"}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"rels", ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"vars", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", " ", "a"}], "]"}], "]"}], " ", "**", " ", 
           RowBox[{"vars", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", " ", "a"}], "]"}], "]"}]}], " ", "-", " ", 
          RowBox[{"vars", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", " ", "a"}], "]"}], "]"}]}]}], "]"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"a", ",", " ", "1", ",", " ", "4"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "1", ",", " ", "7"}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AppendTo", "[", 
     RowBox[{"rels", ",", " ", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"vars", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", " ", "a"}], "]"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"a", ",", " ", "1", ",", " ", "4"}], "}"}]}], "]"}], " ", 
       "-", " ", "1"}]}], "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "1", ",", " ", "7"}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetMonomialOrder", "[", 
   RowBox[{"Flatten", "[", "vars", "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetNonCommutative", "[", "e", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"gb", " ", "=", " ", 
     RowBox[{"NCMakeGB", "[", 
      RowBox[{"rels", ",", " ", "10"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "gb"}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.928158683106872*^9, 3.9281587582831*^9}, {
   3.928158953137593*^9, 3.928159033838627*^9}, {3.928159130298408*^9, 
   3.9281591498687973`*^9}, {3.928159866347143*^9, 3.928160142157294*^9}, 
   3.928160183376478*^9, {3.928160258697312*^9, 3.9281603022022686`*^9}, {
   3.9281604146245785`*^9, 3.928160454946039*^9}, {3.928160526347939*^9, 
   3.928160543104428*^9}, 3.928160640910314*^9, {3.928163621612839*^9, 
   3.928163687991268*^9}, {3.928230629061805*^9, 3.9282306369289913`*^9}, {
   3.928233403301157*^9, 3.9282334149894257`*^9}, {3.9282335704450855`*^9, 
   3.928233581028673*^9}, {3.928233864257212*^9, 3.9282338696760616`*^9}, 
   3.928695921488598*^9, 3.9286959957003117`*^9},
 CellLabel->
  "In[1397]:=",ExpressionUUID->"4e9251e3-0bbe-d34f-b4fe-7e4e33d24b2e"],

Cell[BoxData[
 TemplateBox[{
  "NCAlgebra", "SmallCapSymbolsNonCommutative", 
   "\"All lower cap single letter symbols (e.g. a,b,c,...) were set as \
noncommutative.\"", 2, 1398, 122, 29125238708093176872, "Local", 
   "NCAlgebra`NCAlgebra"},
  "MessageTemplate2"]], "Message", "MSG",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.928230645789618*^9, 3.928695925316299*^9, {3.928776723534413*^9, 
   3.9287767236442013`*^9}},ExpressionUUID->"aefb5b7f-7589-7647-b1f6-\
855eec67fbb4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BoundedDegreeMonomials", "[", 
     RowBox[{"poly_", ",", " ", "vars_", ",", " ", "deg_"}], "]"}], " ", ":=",
     " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "monomials", ",", " ", "submonomials", ",", " ", "degrees", ",", " ", 
        "indices", ",", " ", "result"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"monomials", " ", "=", " ", 
        RowBox[{"NCMonomialList", "[", 
         RowBox[{"poly", ",", " ", "vars"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"submonomials", " ", "=", " ", 
        RowBox[{"monomials", " ", "/.", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"s_Symbol", ",", " ", "i_", ",", " ", "j_"}], "]"}], " ", 
           ":>", " ", "a"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"degrees", " ", "=", " ", 
        RowBox[{"Exponent", "[", 
         RowBox[{"submonomials", ",", " ", "a"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"indices", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"degrees", "[", 
             RowBox[{"[", "i", "]"}], "]"}], " ", "<=", " ", "deg"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"indices", ",", " ", "i"}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "1", ",", " ", 
           RowBox[{"Length", "[", "degrees", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"result", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"result", ",", " ", 
           RowBox[{"monomials", "[", 
            RowBox[{"[", 
             RowBox[{"indices", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "1", ",", " ", 
           RowBox[{"Length", "[", "indices", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Choices", " ", "=", " ", 
     RowBox[{"Subsets", "[", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", " ", "28"}], "]"}], ",", " ", 
       RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"allVars", " ", "=", " ", 
     RowBox[{"Flatten", "[", "vars", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varsComb", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"allVars", "[", 
          RowBox[{"[", 
           RowBox[{"Choices", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", " ", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
         " ", 
         RowBox[{"allVars", "[", 
          RowBox[{"[", 
           RowBox[{"Choices", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", " ", "2"}], "]"}], "]"}], "]"}], "]"}], ",", 
         " ", 
         RowBox[{"allVars", "[", 
          RowBox[{"[", 
           RowBox[{"Choices", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", " ", "3"}], "]"}], "]"}], "]"}], "]"}]}], 
        "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "1", ",", " ", 
         RowBox[{"Length", "[", "Choices", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Monomials", " ", "=", " ", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"expr", " ", "=", " ", 
       RowBox[{"NonCommutativeMultiply", " ", "@@", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"1", " ", "+", " ", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"varsComb", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"j", ",", " ", "1", ",", " ", "3"}], "}"}]}], "]"}]}], 
          ",", " ", 
          RowBox[{"{", "3", "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"Monomials", ",", " ", 
        RowBox[{"BoundedDegreeMonomials", "[", 
         RowBox[{"expr", ",", " ", 
          RowBox[{"varsComb", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", " ", "d"}], "]"}]}], "]"}]}], 
     ",", "\[IndentingNewLine]", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", 
       RowBox[{"Length", "[", "varsComb", "]"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Monomials", " ", "=", " ", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"Flatten", "[", "Monomials", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.92824059889302*^9, 3.928240866339466*^9}, {
   3.928240932144399*^9, 3.928240944928692*^9}, {3.928241482191843*^9, 
   3.928241532053526*^9}, {3.92824448901626*^9, 3.928244508844136*^9}, {
   3.9282445424798603`*^9, 3.928244558912779*^9}, {3.928244622448089*^9, 
   3.928244679454744*^9}, {3.9282447293737125`*^9, 3.9282447307061043`*^9}, {
   3.9282448035759697`*^9, 3.928245013981178*^9}, {3.928245051619301*^9, 
   3.928245071899107*^9}, {3.928245107347681*^9, 3.928245145241811*^9}, {
   3.928245220527305*^9, 3.928245224830223*^9}, {3.928245265914604*^9, 
   3.9282452660016193`*^9}, {3.928245317704054*^9, 3.9282454462153664`*^9}, {
   3.9282456089789734`*^9, 3.9282456121654987`*^9}, {3.928245663396641*^9, 
   3.928245717036793*^9}, {3.928245753817623*^9, 3.92824581459729*^9}, {
   3.9282459269887066`*^9, 3.928245941467886*^9}, {3.9282459941057835`*^9, 
   3.928245994181572*^9}, {3.928258005701311*^9, 3.9282580614023266`*^9}, {
   3.928343132702169*^9, 3.928343141589659*^9}, {3.9285203175168495`*^9, 
   3.928520328836495*^9}, 3.9287767259432106`*^9, {3.928776789141512*^9, 
   3.928776789293335*^9}},ExpressionUUID->"e81fc51d-b930-2648-aeca-\
eccee976689c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"P", "-", 
      RowBox[{
      "satz", " ", "criterion", " ", "to", " ", "test", " ", "the", " ", 
       "existence", " ", "of", " ", 
       SubscriptBox["f", "i"]}]}], " ", ">=", " ", "0"}], ",", " ", 
    RowBox[{
     SubscriptBox["h", "j"], " ", "=", " ", 
     RowBox[{"0", " ", "for", " ", "every", " ", "i"}]}], ",", " ", "j"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Find", " ", "whether", " ", "f"}], " ", "+", " ", "h"}], " ", 
    "=", " ", 
    RowBox[{"-", "1"}]}], " ", "*)"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.928596144807331*^9, 3.9285962336488953`*^9}, 
   3.92860033088578*^9},ExpressionUUID->"84bad4b7-c680-5d4a-8d51-\
d3f1071768d5"],

Cell[BoxData[{
 RowBox[{"<<", " ", "NC`"}], "\[IndentingNewLine]", 
 RowBox[{"<<", " ", "NCAlgebra`"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", " ", "NCReplace`"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xvar", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Subscript", "[", 
      RowBox[{"x", ",", " ", "i"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"f1", " ", "=", " ", 
   RowBox[{
    RowBox[{"3", 
     SubscriptBox["x", "2"]}], " ", "-", " ", 
    RowBox[{
     SubscriptBox["x", "1"], "^", "2"}], " ", "-", " ", "2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2", " ", "=", " ", 
   RowBox[{
    SubscriptBox["x", "1"], " ", "-", " ", 
    RowBox[{"8", 
     RowBox[{
      SubscriptBox["x", "2"], "^", "3"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"h", " ", "=", " ", 
    RowBox[{
     RowBox[{
      SubscriptBox["x", "1"], "^", "2"}], " ", "+", " ", 
     RowBox[{
      SubscriptBox["x", "2"], "^", "2"}], " ", "-", " ", "1"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"generateTuples", "[", 
     RowBox[{"n_", ",", "d_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vars", ",", "constraints", ",", "solutions"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vars", "=", 
        RowBox[{"Array", "[", 
         RowBox[{"x", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"constraints", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", "vars", "]"}], "==", "d"}], ",", 
          RowBox[{"And", "@@", 
           RowBox[{"Thread", "[", 
            RowBox[{"vars", ">=", "0"}], "]"}]}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"solutions", "=", 
        RowBox[{"Solve", "[", 
         RowBox[{"constraints", ",", "vars", ",", "Integers"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"vars", "/.", " ", "solutions"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Generate", " ", "the", " ", "monomial", " ", "vector", " ", "with", " ", 
     "variables", " ", "in", " ", "vector", " ", "x"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["x", "1"], ",", " ", "...", ",", " ", 
       SubscriptBox["x", "n"]}], " ", "}"}], " ", "and", " ", "bounded", " ", 
     "degree", " ", "d"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"monoidVec", "[", 
    RowBox[{"x_", ",", " ", "d_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "n", ",", " ", "partitions", ",", " ", "len", ",", " ", "expr", ",", 
       " ", "vec"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", " ", "=", " ", 
       RowBox[{"Length", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"len", " ", "=", " ", 
       RowBox[{"Binomial", "[", 
        RowBox[{
         RowBox[{"n", "+", "d"}], ",", " ", "d"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vec", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"{", "1", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"partitions", " ", "=", 
          RowBox[{"Reverse", "[", 
           RowBox[{"generateTuples", "[", 
            RowBox[{"n", ",", " ", "i"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"expr", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"expr", " ", "=", " ", 
               RowBox[{"expr", " ", "*", " ", 
                RowBox[{
                 RowBox[{"x", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], "^", 
                 RowBox[{"partitions", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", " ", "k"}], "]"}], "]"}]}]}]}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"k", ",", " ", "1", ",", " ", "n"}], "}"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"vec", ",", " ", 
              RowBox[{"{", "expr", "}"}]}], "]"}], ";"}], 
           "\[IndentingNewLine]", ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", "1", ",", " ", 
             RowBox[{"Length", "[", "partitions", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", "d"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "vec"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PolyDegree", "[", "poly_", "]"}], " ", ":=", " ", 
   RowBox[{"Max", "[", 
    RowBox[{"Cases", "[", 
     RowBox[{
      RowBox[{"CoefficientRules", "[", "poly", "]"}], ",", 
      RowBox[{
       RowBox[{"v_", "?", "VectorQ"}], ":>", 
       RowBox[{"Total", "[", "v", "]"}]}], ",", "2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"monoidDegree", "[", 
     RowBox[{"poly_", ",", " ", "k_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Max", "[", 
     RowBox[{"0", ",", " ", 
      RowBox[{"Floor", "[", " ", 
       RowBox[{"k", " ", "-", " ", 
        RowBox[{
         RowBox[{"PolyDegree", "[", "poly", "]"}], " ", "/", " ", "2"}]}], 
       " ", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"xvec1", " ", "=", " ", 
     RowBox[{"monoidVec", "[", 
      RowBox[{"xvar", ",", " ", "t1"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"f1mat", " ", "=", " ", 
     RowBox[{"Expand", "[", 
      RowBox[{"f1", " ", "*", " ", 
       RowBox[{"xvec1", ".", 
        RowBox[{"Transpose", "[", "xvec1", "]"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "List", " ", "for", " ", "each", " ", "matrix", " ", "in", " ", "alpha", 
      " ", "in", " ", 
      SuperscriptBox[
       SubscriptBox["N", 
        RowBox[{"2", "k"}]], "n"]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"constMatrix", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", " ", 
       RowBox[{"Dimensions", "[", "f1mat", "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"fullxVec", " ", "=", " ", 
     RowBox[{"monoidVec", "[", 
      RowBox[{"xvar", ",", " ", 
       RowBox[{"2", "k"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"constMatrix", "[", 
            RowBox[{"[", 
             RowBox[{"a", ",", " ", "b"}], "]"}], "]"}], " ", "=", " ", 
           RowBox[{
            RowBox[{"f1mat", "[", 
             RowBox[{"[", 
              RowBox[{"a", ",", " ", "b"}], "]"}], "]"}], " ", "/.", " ", 
            RowBox[{"_Subscript", " ", ":>", " ", "0"}]}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"b", ",", " ", "1", ",", " ", 
            RowBox[{
             RowBox[{"Dimensions", "[", "f1mat", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]",
          "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"a", ",", " ", "1", ",", " ", 
          RowBox[{
           RowBox[{"Dimensions", "[", "f1mat", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], "\[IndentingNewLine]", "coefficientMatrices"}], " ", "=", " ", 
     RowBox[{"{", "constMatrix", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"imat", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", " ", 
          RowBox[{"Dimensions", "[", "f1mat", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"imat", "[", 
              RowBox[{"[", 
               RowBox[{"a", ",", " ", "b"}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{
              RowBox[{"Coefficient", "[", 
               RowBox[{
                RowBox[{"f1mat", "[", 
                 RowBox[{"[", 
                  RowBox[{"a", ",", " ", "b"}], "]"}], "]"}], ",", " ", 
                RowBox[{"fullxVec", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "/.",
               " ", 
              RowBox[{"_Subscript", " ", ":>", " ", "0"}]}]}], ";"}], 
           "\[IndentingNewLine]", ",", " ", 
           RowBox[{"{", 
            RowBox[{"b", ",", " ", "1", ",", " ", 
             RowBox[{
              RowBox[{"Dimensions", "[", "f1mat", "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"a", ",", " ", "1", ",", " ", 
           RowBox[{
            RowBox[{"Dimensions", "[", "f1mat", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"coefficientMatrices", ",", " ", "imat"}], "]"}]}], 
      "\[IndentingNewLine]", ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "2", ",", " ", 
        RowBox[{"Length", "[", 
         RowBox[{"Flatten", "[", "fullxVec", "]"}], "]"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"f1mat", " ", "//", " ", 
     RowBox[{"MatrixForm", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
          RowBox[{"MatrixForm", "[", 
           RowBox[{"coefficientMatrices", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", " ", 
          RowBox[{"fullxVec", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "coefficientMatrices", "]"}]}], "}"}]}], 
       "]"}]}]}]}], "*)"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Decompose", " ", "the", " ", "coefficient", " ", "matrices", " ", "on", 
     " ", "monomial", " ", 
     SubscriptBox[
      RowBox[{"basis", " ", "[", "x", "]"}], "t"]}], ","}], "  ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coefficientMatrix", "[", 
    RowBox[{"f_", ",", " ", "k_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "t", ",", " ", "xvec", ",", " ", "fmat", ",", " ", "constMat", ",", " ",
        "coefMat", ",", " ", "imat", ",", " ", "fullxVec"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t", " ", "=", " ", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"monoidDegree", "[", 
          RowBox[{"f", ",", " ", "k"}], "]"}], ",", " ", "0"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xvec", " ", "=", " ", 
       RowBox[{"monoidVec", "[", 
        RowBox[{"xvar", ",", " ", "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fmat", " ", "=", " ", 
       RowBox[{"Expand", "[", 
        RowBox[{"f", " ", "*", " ", 
         RowBox[{"xvec", ".", 
          RowBox[{"Transpose", "[", "xvec", "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"constMat", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"Dimensions", "[", "fmat", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fullxVec", " ", "=", " ", 
       RowBox[{"monoidVec", "[", 
        RowBox[{"xvar", ",", " ", 
         RowBox[{"2", "k"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"constMat", "[", 
            RowBox[{"[", 
             RowBox[{"a", ",", " ", "b"}], "]"}], "]"}], " ", "=", " ", 
           RowBox[{
            RowBox[{"fmat", "[", 
             RowBox[{"[", 
              RowBox[{"a", ",", " ", "b"}], "]"}], "]"}], " ", "/.", " ", 
            RowBox[{"_Subscript", " ", ":>", " ", "0"}]}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"b", ",", " ", "1", ",", " ", 
            RowBox[{
             RowBox[{"Dimensions", "[", "fmat", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]",
          "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"a", ",", " ", "1", ",", " ", 
          RowBox[{
           RowBox[{"Dimensions", "[", "fmat", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"coefMat", " ", "=", " ", 
       RowBox[{"{", "constMat", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"imat", " ", "=", " ", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", " ", 
            RowBox[{"Dimensions", "[", "fmat", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"imat", "[", 
                RowBox[{"[", 
                 RowBox[{"a", ",", " ", "b"}], "]"}], "]"}], " ", "=", " ", 
               RowBox[{
                RowBox[{"Coefficient", "[", 
                 RowBox[{
                  RowBox[{"fmat", "[", 
                   RowBox[{"[", 
                    RowBox[{"a", ",", " ", "b"}], "]"}], "]"}], ",", " ", 
                  RowBox[{"fullxVec", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", 
                "/.", " ", 
                RowBox[{"_Subscript", " ", ":>", " ", "0"}]}]}], ";"}], 
             "\[IndentingNewLine]", ",", " ", 
             RowBox[{"{", 
              RowBox[{"b", ",", " ", "1", ",", " ", 
               RowBox[{
                RowBox[{"Dimensions", "[", "fmat", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"a", ",", " ", "1", ",", " ", 
             RowBox[{
              RowBox[{"Dimensions", "[", "fmat", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"coefMat", ",", " ", "imat"}], "]"}]}], 
        "\[IndentingNewLine]", ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "2", ",", " ", 
          RowBox[{"Length", "[", 
           RowBox[{"Flatten", "[", "fullxVec", "]"}], "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"coefMat", ",", " ", "fmat"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "basis", " ", "transformation", " ", "matrix", " ", "on", " ", 
    SubscriptBox[
     RowBox[{"R", "[", "x", "]"}], 
     RowBox[{
      RowBox[{"2", "k"}], " ", "-", " ", 
      RowBox[{"deg", 
       RowBox[{"(", "h", ")"}]}]}]]}], "  ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"matrixVectorH", "[", 
    RowBox[{"k_", ",", " ", "h_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "degh", ",", " ", "p", ",", " ", "basis", ",", " ", "alpha", ",", " ", 
       "ppoly", ",", " ", "vecp", ",", " ", "leadterm", ",", " ", "vechp", 
       ",", " ", "hp", ",", " ", "H"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"degh", " ", "=", " ", 
       RowBox[{"PolyDegree", "[", "h", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p", " ", "=", " ", 
       RowBox[{"monoidVec", "[", 
        RowBox[{"xvar", ",", " ", 
         RowBox[{
          RowBox[{"2", "k"}], " ", "-", " ", "degh"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"basis", " ", "=", " ", 
       RowBox[{"monoidVec", "[", 
        RowBox[{"xvar", ",", " ", 
         RowBox[{"2", "k"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"alpha", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{"a", ",", " ", "i"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "1", ",", " ", 
           RowBox[{"Length", "[", "p", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ppoly", " ", "=", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"alpha", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "*", " ", 
          RowBox[{"p", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "1", ",", " ", 
           RowBox[{"Length", "[", "p", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vecp", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"Length", "[", "p", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"vecp", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
         RowBox[{"alpha", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "p", "]"}]}], "}"}]}], "\[IndentingNewLine]",
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"vechp", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"Length", "[", "basis", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"hp", " ", "=", " ", 
       RowBox[{"Expand", "[", 
        RowBox[{"ppoly", " ", "*", " ", "h"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"leadterm", " ", "=", " ", 
       RowBox[{"hp", " ", "/.", " ", 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{"x", ",", " ", "_"}], "]"}], " ", ":>", " ", "0"}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vechp", "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
       RowBox[{"leadterm", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"vechp", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{"hp", ",", " ", 
             RowBox[{"basis", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "/.", " ", 
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"x", ",", " ", "_"}], "]"}], " ", ":>", " ", "0"}]}]}], 
        ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "2", ",", " ", 
          RowBox[{"Length", "[", "basis", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"vechp", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"vechp", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "}"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "vechp", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<H * \>\"", ",", " ", 
          RowBox[{"MatrixForm", "[", "vecp", "]"}], ",", " ", "\"\< = \>\"", 
          ",", " ", 
          RowBox[{"MatrixForm", "[", "vechp", "]"}]}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"H", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Length", "[", "vechp", "]"}], ",", " ", 
           RowBox[{"Length", "[", "vecp", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"H", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], " ", "=", " ", 
            RowBox[{"Coefficient", "[", 
             RowBox[{
              RowBox[{"vechp", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", " ", "1"}], "]"}], "]"}], ",", " ", 
              RowBox[{"vecp", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";"}], 
          "\[IndentingNewLine]", ",", " ", 
          RowBox[{"{", 
           RowBox[{"j", ",", " ", "1", ",", " ", 
            RowBox[{"Length", "[", "vecp", "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "vechp", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "H"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coefficientVec", "[", 
    RowBox[{"g_", ",", " ", "k_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xvec", ",", " ", "returnVec"}], "}"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xvec", " ", "=", " ", 
       RowBox[{"monoidVec", "[", 
        RowBox[{"xvar", ",", " ", 
         RowBox[{"2", "k"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"returnVec", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"Length", "[", "xvec", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"returnVec", "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
       RowBox[{"g", " ", "/.", " ", 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{"x", ",", " ", "_"}], "]"}], " ", ":>", " ", "0"}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"returnVec", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"Coefficient", "[", 
           RowBox[{"g", ",", " ", 
            RowBox[{"xvec", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "/.", 
          " ", 
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"x", ",", " ", "_"}], "]"}], " ", ":>", " ", "0"}]}]}], 
        ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "2", ",", " ", 
          RowBox[{"Length", "[", "xvec", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"returnVec", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"returnVec", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "}"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "returnVec", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "returnVec"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PythonListConverter", "[", "expr_", "]"}], " ", ":=", " ", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", "expr", "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<{\>\"", " ", ":>", " ", "\"\<[\>\""}], ",", " ", 
        RowBox[{"\"\<}\>\"", " ", ":>", " ", "\"\<]\>\""}]}], "}"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", " ", "=", " ", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", " ", "=", " ", 
   RowBox[{"monoidDegree", "[", 
    RowBox[{"f1", ",", " ", "k"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t2", " ", "=", " ", 
   RowBox[{"monoidDegree", "[", 
    RowBox[{"f2", ",", " ", "k"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"H", " ", "=", " ", 
   RowBox[{"matrixVectorH", "[", 
    RowBox[{"k", ",", " ", "h"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"F0coef", " ", "=", " ", 
   RowBox[{
    RowBox[{"coefficientMatrix", "[", 
     RowBox[{"1", ",", " ", "k"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"F1coef", " ", "=", " ", 
   RowBox[{
    RowBox[{"coefficientMatrix", "[", 
     RowBox[{"f1", ",", " ", "k"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"F2coef", " ", "=", " ", 
   RowBox[{
    RowBox[{"coefficientMatrix", "[", 
     RowBox[{"f2", ",", " ", "k"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F12coef", " ", "=", " ", 
    RowBox[{
     RowBox[{"coefficientMatrix", "[", 
      RowBox[{
       RowBox[{"Expand", "[", 
        RowBox[{"f1", " ", "*", " ", "f2"}], "]"}], ",", " ", "k"}], "]"}], 
     "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Psatz", ":", " ", 
    RowBox[{
     RowBox[{"whether", " ", "g", " ", "is", " ", "in", " ", "ideal", 
      RowBox[{"(", "h", ")"}]}], " ", "+", " ", 
     RowBox[{"qCone", 
      RowBox[{"(", "f", ")"}], " ", "on", " ", "degree", " ", "bound", " ", 
      "2", "k"}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PstazVerifier", "[", 
    RowBox[{"fset_", ",", " ", "hset_", ",", " ", "g_", ",", " ", "k_"}], 
    "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "lenf", ",", " ", "lenh", ",", " ", "Hlist", ",", " ", "Flist", ",", 
       " ", "SOScomb", ",", " ", "fcombs", ",", " ", "gvec", ",", " ", 
       "Hstring", ",", " ", "Fstring", ",", " ", "gstring", ",", " ", 
       "string"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lenf", " ", "=", " ", 
       RowBox[{"Length", "[", "fset", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lenh", " ", "=", " ", 
       RowBox[{"Length", "[", "hset", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Hlist", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"matrixVectorH", "[", 
          RowBox[{"k", ",", " ", 
           RowBox[{"hset", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "1", ",", " ", "lenh"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"SOScomb", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"choices", " ", "=", " ", 
          RowBox[{"Subsets", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", " ", "lenf"}], "]"}], ",", " ", 
            RowBox[{"{", "i", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"SOScomb", ",", " ", 
             RowBox[{"choices", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", "1", ",", " ", 
             RowBox[{"Length", "[", "choices", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", "lenf"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"fcombs", " ", "=", " ", 
       RowBox[{"{", "1", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"fcombs", ",", " ", 
          RowBox[{"Expand", "[", 
           RowBox[{"Product", "[", 
            RowBox[{
             RowBox[{"fset", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", 
               RowBox[{"SOScomb", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
         "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "SOScomb", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Flist", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"coefficientMatrix", "[", 
           RowBox[{
            RowBox[{"fcombs", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", " ", "k"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "1", ",", " ", 
           RowBox[{"Length", "[", "fcombs", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gvec", " ", "=", " ", 
       RowBox[{"coefficientVec", "[", 
        RowBox[{"g", ",", " ", "k"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Hstring", " ", "=", " ", 
       RowBox[{"PythonListConverter", "[", "Hlist", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Fstring", " ", "=", " ", 
       RowBox[{"PythonListConverter", "[", "Flist", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gstring", " ", "=", " ", 
       RowBox[{"PythonListConverter", "[", "gvec", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"string", " ", "=", " ", 
       RowBox[{
       "Hstring", " ", "<>", " ", "\"\<\\n\>\"", " ", "<>", "  ", "Fstring", 
        " ", "<>", " ", "\"\<\\n\>\"", " ", "<>", " ", "gstring"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
       "\"\<C:/Users/He Entong/OneDrive - The University of Hong Kong - \
Connect/\:6587\:6863/Boolean Constraint System and Non-local \
Games/mathematica_codes/data.txt\>\"", ",", " ", "string"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PstazVerifier", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"f1", ",", " ", "f2"}], "}"}], ",", " ", 
    RowBox[{"{", "h", "}"}], ",", " ", 
    RowBox[{"-", "1"}], ",", " ", "k"}], "]"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InitializeIndeterminant", "[", "n_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Xvar", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ToExpression", "[", 
          RowBox[{"\"\<X\>\"", "<>", 
           RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}], 
      ";"}]}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{"Initialize", " ", "the", " ", "global", " ", "variables", " ", 
      SubscriptBox["X", "i"], "s"}], " ", "*)"}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NCMonoidVec", "[", 
    RowBox[{"variables_", ",", " ", "d_", ",", " ", "rules_"}], "]"}], " ", ":=",
    " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "returnVec", ",", " ", "alphaCombinations", ",", " ", 
       "nonCommutativeProducts"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"returnVec", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"{", "1", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"alphaCombinations", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{"0", ",", "k"}], "]"}], ",", 
              RowBox[{"Length", "[", "variables", "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Total", "[", "#", "]"}], "==", "k"}], "&"}]}], "]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"nonCommutativeProducts", "=", 
          RowBox[{"Reverse", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Permutations", "[", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"ConstantArray", "[", 
                    RowBox[{
                    RowBox[{"variables", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"alphaCombinations", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "Xvar", "]"}]}], "}"}]}], "]"}], 
                 "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"Length", "[", "alphaCombinations", "]"}]}], "}"}]}],
               "]"}], ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"nonCommutativeProducts", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"NCReplaceRepeated", "[", 
              RowBox[{
               RowBox[{"Fold", "[", 
                RowBox[{"NonCommutativeMultiply", ",", " ", 
                 RowBox[{"nonCommutativeProducts", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", 
               "rules"}], "]"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", "1", ",", " ", 
              RowBox[{"Length", "[", "nonCommutativeProducts", "]"}]}], 
             "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"returnVec", ",", " ", 
             RowBox[{"nonCommutativeProducts", "[", 
              RowBox[{"[", "r", "]"}], "]"}]}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"r", ",", " ", "1", ",", " ", 
             RowBox[{"Length", "[", "nonCommutativeProducts", "]"}]}], 
            "}"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"k", ",", " ", "1", ",", " ", "d"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"returnVec", " ", "=", " ", 
       RowBox[{"Union", "[", "returnVec", "]"}]}], ";", "\[IndentingNewLine]",
       "returnVec"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NCPolyDegree", "[", "NCPoly_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"expr", ",", " ", "constInExpr", ",", " ", 
      RowBox[{"returnVal", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"expr", " ", "=", 
      RowBox[{"NCExpand", "[", 
       RowBox[{"NCPoly", " ", "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Alternatives", " ", "@@", " ", "Xvar"}], " ", ":>", " ", 
          "a"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"constInExpr", " ", "=", " ", 
      RowBox[{"expr", " ", "/.", " ", 
       RowBox[{"{", 
        RowBox[{"a", " ", ":>", " ", "0"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"expr", " ", "=", " ", 
      RowBox[{"expr", " ", "-", " ", "constInExpr"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"expr", " ", "==", " ", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"returnVal", " ", "=", " ", "0"}], ",", " ", ",", " ", 
       RowBox[{"returnVal", " ", "=", " ", 
        RowBox[{"Exponent", "[", 
         RowBox[{"expr", ",", " ", "a"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "returnVal"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NCMonoidDegree", "[", 
     RowBox[{"poly_", ",", " ", "k_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Max", "[", 
     RowBox[{"0", ",", " ", 
      RowBox[{"Floor", "[", 
       RowBox[{"k", " ", "-", " ", 
        RowBox[{
         RowBox[{"NCPolyDegree", "[", "poly", "]"}], " ", "/", " ", "2"}]}], 
       "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NCMatrixMul", "[", 
    RowBox[{"F_", ",", " ", "G_", ",", " ", "rules_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dimF", ",", " ", "dimG", ",", " ", "FG", ",", " ", "Sum"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dimF", " ", "=", " ", 
       RowBox[{"Dimensions", "[", "F", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dimG", " ", "=", " ", 
       RowBox[{"Dimensions", "[", "G", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"dimF", "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", "!=", " ", 
         RowBox[{"dimG", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Throw", "[", "\"\<Invalid input.\>\"", "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"FG", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"dimF", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
           RowBox[{"dimG", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Sum", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Sum", " ", "=", " ", 
              RowBox[{"Sum", " ", "+", " ", 
               RowBox[{
                RowBox[{"F", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", " ", "k"}], "]"}], "]"}], " ", "**", " ", 
                RowBox[{"G", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", ",", " ", "j"}], "]"}], "]"}]}]}]}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"k", ",", " ", "1", ",", " ", 
               RowBox[{"dimF", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"FG", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], " ", "=", 
            RowBox[{"NCReplaceRepeated", "[", 
             RowBox[{
              RowBox[{"NCExpand", "[", "Sum", "]"}], ",", " ", "rules"}], 
             "]"}]}], ";"}], "\[IndentingNewLine]", ",", " ", 
          RowBox[{"{", 
           RowBox[{"j", ",", " ", "1", ",", " ", 
            RowBox[{"dimG", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]",
          "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", 
          RowBox[{"dimF", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "FG"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Matrix", " ", "right", " ", "multiplication"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NCScalarize", "[", " ", 
    RowBox[{"NCMat_", ",", " ", "scalar_", ",", " ", "rules_"}], "]"}], " ", ":=",
    " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "dupMat", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dupMat", " ", "=", " ", "NCMat"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"dupMat", "[", 
            RowBox[{"[", 
             RowBox[{"a", ",", " ", "b"}], "]"}], "]"}], " ", "=", " ", 
           RowBox[{"NCReplaceRepeated", "[", 
            RowBox[{
             RowBox[{"NCExpand", "[", 
              RowBox[{
               RowBox[{"dupMat", "[", 
                RowBox[{"[", 
                 RowBox[{"a", ",", " ", "b"}], "]"}], "]"}], " ", "**", " ", 
               "scalar"}], "]"}], ",", " ", "rules"}], "]"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"b", ",", " ", "1", ",", " ", 
            RowBox[{
             RowBox[{"Dimensions", "[", "NCMat", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]",
          "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"a", ",", " ", "1", ",", " ", 
          RowBox[{
           RowBox[{"Dimensions", "[", "NCMat", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "dupMat"}]}], "\[IndentingNewLine]",
     "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NCCoefficientMatrix", "[", 
    RowBox[{"f_", ",", " ", "k_", ",", " ", "rules_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "t", ",", " ", "xvec", ",", " ", "NCfmat", ",", " ", "constMat", ",", 
       " ", "fullNCBasis", ",", " ", "NCcoefMat", ",", " ", "NCimat", ",", 
       " ", "counter", ",", " ", "NonZeroIndices", ",", " ", "coef"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t", " ", "=", " ", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"NCMonoidDegree", "[", 
          RowBox[{"f", ",", " ", "k"}], "]"}], ",", " ", "0"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xvec", " ", "=", " ", 
       RowBox[{"NCMonoidVec", "[", 
        RowBox[{"Xvar", ",", " ", "t", ",", " ", "rules"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"NCfmat", " ", "=", " ", 
       RowBox[{"NCScalarize", "[", 
        RowBox[{
         RowBox[{"NCMatrixMul", "[", 
          RowBox[{"xvec", ",", " ", 
           RowBox[{"Transpose", "[", "xvec", "]"}], ",", " ", "rules"}], 
          "]"}], ",", " ", "f", ",", " ", "rules"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"constMat", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fullNCBasis", " ", "=", " ", 
       RowBox[{"NCMonoidVec", "[", 
        RowBox[{"Xvar", ",", " ", 
         RowBox[{"2", "k"}], ",", " ", "rules"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"coef", " ", "=", " ", 
            RowBox[{
             RowBox[{"NCfmat", "[", 
              RowBox[{"[", 
               RowBox[{"a", ",", " ", "b"}], "]"}], "]"}], " ", "/.", " ", 
             RowBox[{
              RowBox[{"Alternatives", " ", "@@", " ", "Xvar"}], " ", ":>", 
              " ", "0"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"coef", " ", "!=", " ", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"constMat", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"a", ",", " ", "b", ",", " ", "coef"}], "}"}]}], 
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", ",", " ", 
          RowBox[{"{", 
           RowBox[{"b", ",", " ", "1", ",", " ", 
            RowBox[{
             RowBox[{"Dimensions", "[", "NCfmat", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]",
          "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"a", ",", " ", "1", ",", " ", 
          RowBox[{
           RowBox[{"Dimensions", "[", "NCfmat", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"NCcoefMat", " ", "=", " ", 
       RowBox[{"{", "constMat", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"NCimat", " ", "=", " ", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Normally", ",", " ", 
           RowBox[{
           "matrices", " ", "F", " ", "will", " ", "be", " ", "sparse"}], ",",
            " ", 
           RowBox[{
            RowBox[{"we", " ", "only", " ", "store", " ", "non"}], "-", 
            RowBox[{
            "zero", " ", "entries", "\[IndentingNewLine]", "\t", "Each", " ", 
             "entry", " ", "of", " ", "F", " ", "is", " ", "stored", " ", 
             "as", " ", 
             RowBox[{"{", 
              RowBox[{"x", ",", " ", "y", ",", " ", 
               SubscriptBox["F", 
                RowBox[{"x", ",", " ", "y"}]]}], "}"}]}]}]}], 
          "\[IndentingNewLine]", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"coef", " ", "=", " ", 
               RowBox[{
                RowBox[{"Coefficient", "[", 
                 RowBox[{
                  RowBox[{"NCfmat", "[", 
                   RowBox[{"[", 
                    RowBox[{"a", ",", " ", "b"}], "]"}], "]"}], ",", " ", 
                  RowBox[{"fullNCBasis", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"coef", " ", "!=", " ", "0"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"NCimat", ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", " ", "b", ",", " ", "coef"}], "}"}]}], 
                 "]"}]}], "\[IndentingNewLine]", "]"}]}], 
             "\[IndentingNewLine]", ",", " ", 
             RowBox[{"{", 
              RowBox[{"b", ",", " ", "1", ",", " ", 
               RowBox[{
                RowBox[{"Dimensions", "[", "NCfmat", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"a", ",", " ", "1", ",", " ", 
             RowBox[{
              RowBox[{"Dimensions", "[", "NCfmat", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"NCcoefMat", ",", " ", "NCimat"}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "2", ",", " ", 
          RowBox[{"Length", "[", "fullNCBasis", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"NCcoefMat", ",", " ", 
        RowBox[{"Length", "[", "xvec", "]"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"For", " ", "the", " ", "left", " ", "ideal", " ", "case"}], ",", 
    " ", 
    RowBox[{
     RowBox[{"we", " ", "have", " ", "coefvec", 
      RowBox[{"(", 
       RowBox[{"p", " ", "**", " ", "h"}], ")"}]}], " ", "=", " ", 
     RowBox[{"H", " ", "coefvec", 
      RowBox[{"(", "p", ")"}]}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NCCoefficientMatrixH", "[", 
    RowBox[{"k_", ",", " ", "h_", ",", " ", "rules_"}], "]"}], "  ", ":=", 
   " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "NCdegh", ",", " ", "p", ",", " ", "fullBasis", ",", " ", "alpha", ",", 
       " ", "NCppoly", ",", " ", "NCph", ",", " ", "vechp", ",", " ", 
       "leadingTerm", ",", " ", "NCH", ",", " ", "vecp", ",", " ", "coef", 
       ",", " ", "transformation"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NCdegh", " ", "=", " ", 
       RowBox[{"NCPolyDegree", "[", "h", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p", " ", "=", 
       RowBox[{"NCMonoidVec", "[", 
        RowBox[{"Xvar", ",", " ", 
         RowBox[{
          RowBox[{"2", "k"}], " ", "-", " ", "NCdegh"}], ",", " ", "rules"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fullBasis", " ", "=", " ", 
       RowBox[{"NCMonoidVec", "[", 
        RowBox[{"Xvar", ",", " ", 
         RowBox[{"2", "k"}], ",", " ", "rules"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"alpha", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{"a", ",", " ", "i"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "1", ",", " ", 
           RowBox[{"Length", "[", "p", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"NCppoly", " ", "=", " ", 
       RowBox[{"NCReplaceRepeated", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"NCExpand", "[", 
            RowBox[{
             RowBox[{"alpha", "[", 
              RowBox[{"[", "i", "]"}], "]"}], " ", "*", " ", 
             RowBox[{"p", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "1", ",", " ", 
             RowBox[{"Length", "[", "p", "]"}]}], "}"}]}], "]"}], ",", " ", 
         "rules"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"NCph", " ", "=", " ", 
       RowBox[{"NCReplaceRepeated", "[", 
        RowBox[{
         RowBox[{"NCExpand", "[", 
          RowBox[{"NCppoly", " ", "**", " ", "h"}], "]"}], ",", " ", 
         "rules"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vecp", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"alpha", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "1", ",", " ", 
           RowBox[{"Length", "[", "p", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vechp", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"Length", "[", "fullBasis", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Normally", ",", " ", 
        RowBox[{"the", " ", "matrix", " ", "H", " ", "is", " ", "sparse"}], 
        ",", " ", 
        RowBox[{
        "so", " ", "we", " ", "store", " ", "the", " ", "linear", " ", 
         "transformation", " ", "rather", " ", "than", " ", "the", " ", 
         "whole", " ", "matrix", "\[IndentingNewLine]", "\t", "Each", " ", 
         "row", " ", "corresponds", " ", "to", " ", "a", " ", 
         "transformation", " ", 
         TemplateBox[<|"boxes" -> FormBox[
             RowBox[{
               SubscriptBox[
                StyleBox["y", "TI"], 
                StyleBox["i", "TI"]], "\[LongEqual]", 
               UnderscriptBox["\[Sum]", 
                StyleBox["j", "TI"], LimitsPositioning -> True], 
               SubscriptBox[
                StyleBox["H", "TI"], 
                RowBox[{
                  StyleBox["i", "TI"], 
                  StyleBox["j", "TI"]}]], 
               SubscriptBox[
                StyleBox["x", "TI"], 
                StyleBox["i", "TI"]]}], TraditionalForm], "errors" -> {}, 
           "input" -> "$y_i = \\sum_j H_{ij} x_i$", "state" -> "Boxes"|>,
          "TeXAssistantTemplate"]}], ",", " ", 
        RowBox[{"specified", " ", "by", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"index", " ", "of", " ", 
            SubscriptBox["x", "i"]}], ",", " ", 
           RowBox[{"coefficient", " ", "of", " ", 
            SubscriptBox["x", "i"]}]}], "}"}]}]}], "\[IndentingNewLine]", " ",
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"leadingTerm", " ", "=", " ", 
       RowBox[{"NCph", " ", "/.", " ", 
        RowBox[{
         RowBox[{"Alternatives", " ", "@@", " ", "Xvar"}], " ", ":>", " ", 
         "0"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vechp", "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
       RowBox[{"{", "leadingTerm", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"vechp", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
         RowBox[{"Coefficient", "[", 
          RowBox[{"NCph", ",", " ", 
           RowBox[{"fullBasis", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "2", ",", " ", 
          RowBox[{"Length", "[", "vechp", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"NCH", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
          RowBox[{"MatrixForm", "[", "vecp", "]"}], ",", " ", 
          RowBox[{"MatrixForm", "[", "vechp", "]"}]}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"transformation", " ", "=", " ", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"coef", " ", "=", " ", 
             RowBox[{"Coefficient", "[", 
              RowBox[{
               RowBox[{"vechp", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", " ", "1"}], "]"}], "]"}], ",", " ", 
               RowBox[{"vecp", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"coef", " ", "!=", " ", "0"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", "\[IndentingNewLine]", 
               RowBox[{"transformation", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"j", ",", " ", "coef"}], "}"}]}], 
               "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
            ";"}], "\[IndentingNewLine]", ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", "1", ",", " ", 
             RowBox[{"Length", "[", "p", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"NCH", ",", " ", "transformation"}], "]"}]}], 
        "\[IndentingNewLine]", ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "vechp", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<Processed an H matrix\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"NCH", ",", " ", 
        RowBox[{"Length", "[", "fullBasis", "]"}], ",", " ", 
        RowBox[{"Length", "[", "p", "]"}]}], "}"}]}]}], "\[IndentingNewLine]",
     "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NCCoefficientVec", "[", 
    RowBox[{"NCpoly_", ",", " ", "k_", ",", " ", "rules_"}], "]"}], " ", ":=",
    " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"fullBasis", ",", " ", "leadingterm", ",", " ", "polyVec"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fullBasis", " ", "=", " ", 
       RowBox[{"NCMonoidVec", "[", 
        RowBox[{"Xvar", ",", " ", 
         RowBox[{"2", "k"}], ",", " ", "rules"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"leadingterm", " ", "=", " ", 
       RowBox[{"NCpoly", " ", "/.", " ", 
        RowBox[{
         RowBox[{"Alternatives", " ", "@@", " ", "Xvar"}], " ", ":>", " ", 
         "0"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"polyVec", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"{", "leadingterm", "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"polyVec", ",", " ", 
          RowBox[{"Coefficient", "[", 
           RowBox[{"NCpoly", ",", " ", 
            RowBox[{"fullBasis", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "2", ",", " ", 
          RowBox[{"Length", "[", "fullBasis", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "polyVec"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Rules", " ", "are", " ", "commutativity", " ", "from", " ", "ideals"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NCPsatz", "[", 
    RowBox[{
    "fset_", ",", " ", "hset_", ",", " ", "g_", ",", " ", "k_", ",", " ", 
     "rules_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "lenf", ",", " ", "lenh", ",", " ", "Hlist", ",", " ", "Hs", ",", " ", 
       "Hshapes", ",", " ", "Flist", ",", " ", "SOScomb", ",", " ", "fcombs", 
       ",", " ", "gvec", ",", " ", "Hstring", ",", " ", "Fstring", ",", " ", 
       "gstring", ",", " ", "string", ",", " ", "Fs", ",", " ", "Fshapes", 
       ",", " ", "FIndexList", ",", " ", "HshapeString", ",", " ", 
       "FshapeString"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lenf", " ", "=", " ", 
       RowBox[{"Length", "[", "fset", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lenh", " ", "=", " ", 
       RowBox[{"Length", "[", "hset", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Hs", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NCCoefficientMatrixH", "[", 
          RowBox[{"k", ",", " ", 
           RowBox[{"hset", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", " ", "rules"}], "]"}], ",", 
         " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "1", ",", " ", "lenh"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Hlist", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Hs", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "1", ",", " ", "lenh"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Hshapes", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Hs", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
           RowBox[{
            RowBox[{"Hs", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "1", ",", " ", "lenh"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"SOScomb", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"choices", " ", "=", " ", 
          RowBox[{"Subsets", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", " ", "lenf"}], "]"}], ",", " ", 
            RowBox[{"{", "i", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"SOScomb", ",", " ", 
             RowBox[{"choices", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", "1", ",", " ", 
             RowBox[{"Length", "[", "choices", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", "lenf"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"fcombs", " ", "=", " ", 
       RowBox[{"{", "1", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"fcombs", ",", " ", 
          RowBox[{"Expand", "[", 
           RowBox[{"Product", "[", 
            RowBox[{
             RowBox[{"fset", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", 
               RowBox[{"SOScomb", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
         "]"}], "\[IndentingNewLine]", ",", " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "SOScomb", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"fcombs", " ", "=", " ", 
       RowBox[{"Union", "[", "fcombs", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Fs", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NCCoefficientMatrix", "[", 
          RowBox[{
           RowBox[{"fcombs", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", " ", "k", ",", " ", 
           "rules"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "1", ",", " ", 
           RowBox[{"Length", "[", "fcombs", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Flist", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Fs", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "1", ",", " ", 
           RowBox[{"Length", "[", "fcombs", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Fshapes", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Fs", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "1", ",", " ", 
           RowBox[{"Length", "[", "fcombs", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gvec", " ", "=", " ", 
       RowBox[{"NCCoefficientVec", "[", 
        RowBox[{"g", ",", " ", "k", ",", " ", "rules"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Hstring", " ", "=", " ", 
       RowBox[{"PythonListConverter", "[", "Hlist", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"HshapeString", " ", "=", " ", 
       RowBox[{"PythonListConverter", "[", "Hshapes", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Fstring", " ", "=", " ", 
       RowBox[{"PythonListConverter", "[", "Flist", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"FshapeString", " ", "=", " ", 
       RowBox[{"PythonListConverter", "[", "Fshapes", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gstring", " ", "=", " ", 
       RowBox[{"PythonListConverter", "[", "gvec", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"string", " ", "=", " ", 
       RowBox[{
       "Hstring", " ", "<>", " ", "\"\<\\n\>\"", " ", "<>", " ", 
        "HshapeString", " ", "<>", " ", "\"\<\\n\>\"", " ", "<>", "  ", 
        "Fstring", " ", "<>", " ", "\"\<\\n\>\"", " ", "<>", " ", 
        "FshapeString", " ", "<>", " ", "\"\<\\n\>\"", " ", "<>", " ", 
        "gstring"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
       "\"\<C:/Users/He Entong/OneDrive - The University of Hong Kong - \
Connect/\:6587\:6863/Boolean Constraint System and Non-local \
Games/mathematica_codes/NCdata.txt\>\"", ",", " ", "string"}], "]"}], ";"}]}],
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InitializeIndeterminant", "[", "9", "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"NCvec", " ", "=", " ", 
     RowBox[{"NCMonoidVec", "[", 
      RowBox[{"Xvar", ",", " ", "k"}], "]"}]}], " ", ";", 
    "\[IndentingNewLine]", 
    RowBox[{"fullNCvec", " ", "=", " ", 
     RowBox[{"NCMonoidVec", "[", 
      RowBox[{"Xvar", ",", " ", 
       RowBox[{"2", "k"}]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"NCCoefficientMatrix", "[", 
     RowBox[{"1", ",", " ", "k"}], "]"}], " ", "//", " ", "MatrixForm"}], 
   "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9286003728600426`*^9, 3.9286004249974384`*^9}, {
   3.928600567587994*^9, 3.928600567783203*^9}, {3.928600833124349*^9, 
   3.928600845605833*^9}, {3.9286962306810875`*^9, 3.9286962344303913`*^9}, {
   3.928696543014665*^9, 3.928696546390059*^9}, {3.928696582204592*^9, 
   3.928696750273173*^9}, {3.928696785234522*^9, 3.928696794229854*^9}, {
   3.9286969006655903`*^9, 3.9286970741001053`*^9}, {3.928697147894827*^9, 
   3.92869717807708*^9}, {3.928697329677658*^9, 3.9286973530385437`*^9}, {
   3.928697391610575*^9, 3.928697446507965*^9}, {3.928755278513617*^9, 
   3.928755309710575*^9}, 3.928755744035437*^9, {3.928756429047029*^9, 
   3.928756481193231*^9}, {3.928756518412663*^9, 3.928756520147858*^9}, {
   3.9287565595187607`*^9, 3.9287565852911034`*^9}, {3.9287567206696453`*^9, 
   3.928756732751124*^9}, {3.928756763406571*^9, 3.928756786140753*^9}, {
   3.928757713392411*^9, 3.92875773889168*^9}, {3.928757805489723*^9, 
   3.928757806517748*^9}, {3.9287720547423*^9, 3.928772223568905*^9}, {
   3.928772271045397*^9, 3.928772327503063*^9}, {3.9287725257991104`*^9, 
   3.928772532652771*^9}, {3.928772671612429*^9, 3.9287727104761276`*^9}, {
   3.928772752597309*^9, 3.9287728651437263`*^9}, 3.928773518558111*^9, {
   3.928774649955742*^9, 3.928774659641781*^9}, {3.928774702975305*^9, 
   3.928774716898438*^9}, {3.9287768117580414`*^9, 3.9287768399650135`*^9}, {
   3.928777256275511*^9, 3.928777260960198*^9}, {3.928777710022745*^9, 
   3.9287777142898464`*^9}, {3.928777805472849*^9, 3.928777842647112*^9}, {
   3.9287779073103046`*^9, 3.928777934779951*^9}, {3.928777986607878*^9, 
   3.928778015187659*^9}, {3.928778051979351*^9, 3.9287781407982407`*^9}, {
   3.9287781827033024`*^9, 3.928778229338518*^9}, {3.928778441908596*^9, 
   3.928778535485308*^9}, {3.928778585507759*^9, 3.928778710612152*^9}, {
   3.928779111897738*^9, 3.928779119652907*^9}, {3.9287792206451035`*^9, 
   3.928779289868389*^9}, {3.928779419543556*^9, 3.9287794568768826`*^9}, {
   3.9287794947744274`*^9, 3.928779560535321*^9}, {3.9287799417187214`*^9, 
   3.928779969033119*^9}, {3.928780018161408*^9, 3.928780133813833*^9}, {
   3.928780411749487*^9, 3.928780466118191*^9}, {3.928780682806763*^9, 
   3.9287808369006376`*^9}, {3.928781250507584*^9, 3.928781340119831*^9}, {
   3.9287814069539604`*^9, 3.928781568869156*^9}, {3.928781639273901*^9, 
   3.928781640349118*^9}, {3.928781700769877*^9, 3.928781701852165*^9}, {
   3.928783218780159*^9, 3.928783227506439*^9}, {3.9287834975262985`*^9, 
   3.928783497733148*^9}, 3.928783605265497*^9, 3.928865589253345*^9, {
   3.9288682036204185`*^9, 3.928868210680448*^9}, 3.928868899579819*^9, {
   3.9289212904098415`*^9, 3.928921331924044*^9}, {3.928921369395479*^9, 
   3.9289213700631046`*^9}, {3.928921414038748*^9, 3.928921419038484*^9}, {
   3.928921696161013*^9, 3.928921819360293*^9}, {3.928921858393812*^9, 
   3.9289218844262714`*^9}, {3.928921930206923*^9, 3.928921956681263*^9}, {
   3.928921990170107*^9, 3.928922018932684*^9}, {3.928922264800293*^9, 
   3.9289223811409645`*^9}, {3.928922478061991*^9, 3.928922548384634*^9}, {
   3.928922610311775*^9, 3.928922634813175*^9}, {3.928922670322224*^9, 
   3.928922674328813*^9}, {3.928922756659033*^9, 3.928922801873305*^9}, {
   3.9289229057947273`*^9, 3.928922961175459*^9}, {3.928922991477551*^9, 
   3.928923041104273*^9}, {3.928923285467385*^9, 3.928923301078324*^9}, {
   3.92892364038432*^9, 3.928923932322304*^9}, {3.928924005470754*^9, 
   3.9289240377555556`*^9}, {3.928924159683754*^9, 3.928924191236454*^9}, {
   3.928924375736967*^9, 3.928924379473944*^9}, {3.928924755765952*^9, 
   3.928924785882967*^9}, {3.928924896437557*^9, 3.928924928183714*^9}, {
   3.9289251223650093`*^9, 3.928925268660824*^9}, {3.928925429863241*^9, 
   3.9289254542478447`*^9}, {3.9289254851365757`*^9, 3.928925491499916*^9}, {
   3.928925524505495*^9, 3.928925529858629*^9}, {3.928925580246626*^9, 
   3.928925711995795*^9}, {3.928925771146314*^9, 3.928925973934765*^9}, {
   3.9289260345357113`*^9, 3.928926146311919*^9}, {3.928926483994951*^9, 
   3.9289264875308247`*^9}, {3.9289265647195454`*^9, 3.928926571661379*^9}, {
   3.928926649267626*^9, 3.928926704016697*^9}, {3.928926758418958*^9, 
   3.928926775487018*^9}, {3.928926832266083*^9, 3.928926833547127*^9}, {
   3.92892688477541*^9, 3.928926892925089*^9}, {3.9289269239317017`*^9, 
   3.9289269242705383`*^9}, {3.928926988399447*^9, 3.928926988744536*^9}, {
   3.928927279802042*^9, 3.928927301504767*^9}, {3.928927536513586*^9, 
   3.928927570054041*^9}, {3.928927612111157*^9, 3.928927621656994*^9}, {
   3.9289278151417656`*^9, 3.928927927736435*^9}, {3.928928980465021*^9, 
   3.928929055070023*^9}, {3.9289291281563606`*^9, 3.928929257277628*^9}, {
   3.928929331485752*^9, 3.928929340499081*^9}, {3.928929396317602*^9, 
   3.928929434444826*^9}, {3.928929620435274*^9, 3.928929654787695*^9}, {
   3.92892972239498*^9, 3.9289299353272247`*^9}, {3.928929974010132*^9, 
   3.928929979869884*^9}, {3.928930015537117*^9, 3.928930032245363*^9}, {
   3.92893007143776*^9, 3.928930127166767*^9}, {3.928930181444657*^9, 
   3.928930181583452*^9}, 3.928930240504505*^9, {3.928930566705445*^9, 
   3.928930587059725*^9}, {3.928930676084572*^9, 3.928930679255232*^9}, {
   3.928930729581518*^9, 3.928930754246832*^9}, {3.928930793491526*^9, 
   3.928930855664364*^9}, {3.928931071921739*^9, 3.928931078049394*^9}, {
   3.9289311243202057`*^9, 3.928931124427819*^9}, {3.9289311864197025`*^9, 
   3.928931245342041*^9}, {3.92893128931128*^9, 3.928931378223727*^9}, {
   3.928931409078417*^9, 3.928931653950629*^9}, {3.9289318566632442`*^9, 
   3.928931858998438*^9}, 3.928931970029415*^9, {3.92893751495493*^9, 
   3.928937529331564*^9}, 3.928939197912545*^9, {3.928944214860699*^9, 
   3.92894423245662*^9}, {3.928944282234535*^9, 3.928944319815876*^9}, {
   3.928945057828771*^9, 3.9289450687685184`*^9}, 3.9289485390662537`*^9, {
   3.9289487289836464`*^9, 3.9289487356510887`*^9}, {3.928949296379989*^9, 
   3.9289493045619793`*^9}, {3.928949336624861*^9, 3.92894933814694*^9}, {
   3.9289497722782726`*^9, 3.9289497855068264`*^9}, {3.9289506319856663`*^9, 
   3.92895068579443*^9}, {3.928950716984494*^9, 3.928950788452755*^9}, {
   3.928950858829985*^9, 3.928950871141007*^9}, {3.928951629693485*^9, 
   3.9289516573581486`*^9}, 3.928951698560639*^9, {3.928951844270073*^9, 
   3.9289519375960026`*^9}, {3.9289520789158325`*^9, 
   3.9289520965510235`*^9}, {3.928954321705519*^9, 3.928954330340843*^9}, {
   3.928954364935778*^9, 3.928954368322624*^9}, {3.928954526024803*^9, 
   3.928954563667681*^9}, {3.928954618519081*^9, 3.928954737753481*^9}, {
   3.928954830696833*^9, 3.928954835136015*^9}, {3.928954886085497*^9, 
   3.9289548888910446`*^9}, {3.928954931161201*^9, 3.928954961004072*^9}, {
   3.92895503401098*^9, 3.9289550399062*^9}, {3.928955125145811*^9, 
   3.92895512603529*^9}, {3.928955158578266*^9, 3.9289551711896343`*^9}, {
   3.9289552058737087`*^9, 3.928955232662695*^9}, {3.928955535392063*^9, 
   3.928955555723867*^9}, {3.928955598586987*^9, 3.928955630128011*^9}, {
   3.928955680743389*^9, 3.928955723680746*^9}, {3.928955769295574*^9, 
   3.9289557725458393`*^9}, {3.9289558628458633`*^9, 3.928955867156025*^9}, 
   3.928956086019634*^9, {3.9289567759179983`*^9, 3.928956813035787*^9}, {
   3.928956923731457*^9, 3.928957154770691*^9}, {3.928957190440105*^9, 
   3.928957216646805*^9}, {3.928957260364237*^9, 3.928957270070244*^9}, {
   3.928957319815697*^9, 3.928957322622381*^9}, {3.9289573677032795`*^9, 
   3.928957439775087*^9}, 3.9289575865294456`*^9, 3.928957730285237*^9, {
   3.929005499537424*^9, 3.929005651802704*^9}, {3.929005729162184*^9, 
   3.9290057309700584`*^9}, {3.929006283121519*^9, 3.9290063771339436`*^9}, {
   3.929006439231655*^9, 3.929006461549019*^9}, 3.92900734416617*^9, {
   3.92900737516222*^9, 3.9290074140035496`*^9}, {3.929007461997017*^9, 
   3.9290074733176384`*^9}, {3.9290077288841515`*^9, 3.929007742332882*^9}, {
   3.9290094793189163`*^9, 3.9290094795012054`*^9}, {3.929009963714905*^9, 
   3.9290099937695637`*^9}, {3.92901022753928*^9, 3.9290102562510357`*^9}, {
   3.929010333570425*^9, 3.9290103995267773`*^9}, {3.929010442630148*^9, 
   3.929010477917839*^9}, {3.929011043005026*^9, 3.9290110536226997`*^9}, {
   3.9290114904949665`*^9, 3.929011517686619*^9}, {3.9290115615990868`*^9, 
   3.9290116479805527`*^9}, {3.9290117460926247`*^9, 3.929011756533081*^9}, {
   3.929011806475025*^9, 3.929011806531389*^9}, {3.92901188680562*^9, 
   3.929011896909132*^9}, {3.92901217838538*^9, 3.9290121998298626`*^9}, {
   3.929012255972971*^9, 3.9290122695152664`*^9}, {3.929012310965046*^9, 
   3.9290123278247433`*^9}, {3.9290123728430157`*^9, 
   3.9290123820777874`*^9}, {3.9290133826235123`*^9, 3.929013383156124*^9}, {
   3.9290134277253895`*^9, 3.9290135956647816`*^9}, {3.929013800020668*^9, 
   3.929013802608433*^9}, {3.929013834288471*^9, 3.9290138702903576`*^9}, {
   3.9290139128911285`*^9, 3.929013928563801*^9}, {3.9290140021584854`*^9, 
   3.929014002380871*^9}, {3.9290161772248783`*^9, 3.9290162348449593`*^9}, {
   3.9290162713699837`*^9, 3.9290163676226196`*^9}, {3.9290236923700237`*^9, 
   3.9290237296755524`*^9}, {3.929024007729252*^9, 3.9290240816934776`*^9}, {
   3.929024118566452*^9, 3.9290241356744194`*^9}, {3.929024732271719*^9, 
   3.9290247325261726`*^9}, {3.929028288930475*^9, 3.929028289603449*^9}},
 CellLabel->
  "In[1665]:=",ExpressionUUID->"d0c1367f-040d-5c42-87a1-3c6d53202cdd"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9288697814809456`*^9, 
  3.928869786627163*^9}},ExpressionUUID->"8beb707d-0c52-5644-8d09-\
719fdfb067ed"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fs", " ", "=", " ", 
   RowBox[{"{", "1", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", " ", "=", " ", 
   RowBox[{"-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hs", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", " ", "=", " ", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Indices", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "2", ",", " ", "3"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"4", ",", " ", "5", ",", " ", "6"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"7", ",", "8", ",", " ", "9"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "4", ",", " ", "7"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"2", ",", " ", "5", ",", " ", "8"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"3", ",", " ", "6", ",", " ", "9"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"com", "[", 
    RowBox[{"a_", ",", " ", "b_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"a", "**", "b"}], " ", "-", " ", 
    RowBox[{"b", "**", "a"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetNonCommutative", "[", 
    RowBox[{"Flatten", "[", "Xvar", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"NCPsatz", "[", 
    RowBox[{"fs", ",", " ", "hs", ",", " ", "g", ",", " ", "2"}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"i", " ", "!=", " ", 
        RowBox[{"Length", "[", "Indices", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", "\[IndentingNewLine]", 
        RowBox[{"hs", ",", " ", 
         RowBox[{
          RowBox[{"Fold", "[", 
           RowBox[{"NonCommutativeMultiply", ",", " ", 
            RowBox[{"Xvar", "[", 
             RowBox[{"[", 
              RowBox[{"Indices", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}], " ", 
          "-", " ", "1"}]}], "\[IndentingNewLine]", "]"}], ",", " ", 
       RowBox[{"AppendTo", "[", "\[IndentingNewLine]", 
        RowBox[{"hs", ",", " ", 
         RowBox[{
          RowBox[{"Fold", "[", 
           RowBox[{"NonCommutativeMultiply", ",", " ", 
            RowBox[{"Xvar", "[", 
             RowBox[{"[", 
              RowBox[{"Indices", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}], " ", 
          "+", " ", "1"}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"a", " ", "<", " ", "b"}], ",", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", "\[IndentingNewLine]", 
            RowBox[{"rules", ",", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"Xvar", "[", 
                RowBox[{"[", 
                 RowBox[{"Indices", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", " ", "b"}], "]"}], "]"}], "]"}], "]"}], 
               " ", "**", " ", 
               RowBox[{"Xvar", "[", 
                RowBox[{"[", 
                 RowBox[{"Indices", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", " ", "a"}], "]"}], "]"}], "]"}], "]"}]}],
               " ", "->", " ", 
              RowBox[{
               RowBox[{"Xvar", "[", 
                RowBox[{"[", 
                 RowBox[{"Indices", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", " ", "a"}], "]"}], "]"}], "]"}], "]"}], 
               " ", "**", " ", 
               RowBox[{"Xvar", "[", 
                RowBox[{"[", 
                 RowBox[{"Indices", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", " ", "b"}], "]"}], "]"}], "]"}], 
                "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"b", ",", " ", "1", ",", " ", 
           RowBox[{"Length", "[", 
            RowBox[{"Indices", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"a", ",", " ", "1", ",", " ", 
         RowBox[{"Length", "[", 
          RowBox[{"Indices", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", " ", 
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "1", ",", " ", 
      RowBox[{"Length", "[", "Indices", "]"}]}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"NCPsatz", "[", 
  RowBox[{
  "fs", ",", " ", "hs", ",", " ", "g", ",", " ", "2", ",", " ", "rules"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.928918834250828*^9, 3.9289189110412025`*^9}, {
   3.928919456351492*^9, 3.928919489259685*^9}, {3.928919652171835*^9, 
   3.928919709146242*^9}, 3.928920047986*^9, {3.928930256760193*^9, 
   3.92893027031621*^9}, {3.928930435011989*^9, 3.928930475244597*^9}, {
   3.9289306987791805`*^9, 3.928930703223009*^9}, {3.928937505504383*^9, 
   3.928937531880362*^9}, 3.928937713506489*^9, {3.928939204686499*^9, 
   3.92893920714209*^9}, {3.9289430253161926`*^9, 3.928943076369116*^9}, {
   3.928943490023609*^9, 3.928943563406718*^9}, {3.9289438844105797`*^9, 
   3.928943975379957*^9}, {3.9289440160610294`*^9, 3.9289440597747536`*^9}, {
   3.928944093355736*^9, 3.928944133128942*^9}, {3.928944239820383*^9, 
   3.9289442784408245`*^9}, {3.9289443154570236`*^9, 3.928944327182886*^9}, {
   3.928944838650593*^9, 3.9289448387451687`*^9}, {3.928945033906868*^9, 
   3.928945033995041*^9}, {3.928945082626161*^9, 3.928945105832714*^9}, {
   3.9289451966943665`*^9, 3.9289452053522663`*^9}, {3.928948606541803*^9, 
   3.92894861953186*^9}, {3.928948656401476*^9, 3.928948715076969*^9}, {
   3.928948967551687*^9, 3.9289489678145065`*^9}, 3.9289508054443684`*^9, {
   3.928951952698469*^9, 3.928952029420644*^9}, {3.928952073681761*^9, 
   3.9289521507228565`*^9}, {3.928952185083849*^9, 3.9289522192715225`*^9}, {
   3.928952270772236*^9, 3.9289522926007557`*^9}, {3.928952333702106*^9, 
   3.928952341689768*^9}, {3.9289523724032593`*^9, 3.928952382014541*^9}, 
   3.928954204244316*^9, {3.928955892956555*^9, 3.928955893111091*^9}, 
   3.92895597029788*^9, {3.928956072061348*^9, 3.928956072186568*^9}, {
   3.928956817398653*^9, 3.928956823807848*^9}, {3.928957198547001*^9, 
   3.9289571986708775`*^9}, {3.928957518741179*^9, 3.928957518892084*^9}, {
   3.929007321714905*^9, 3.929007340416874*^9}, {3.9290073838384533`*^9, 
   3.92900738550613*^9}, {3.929009466699436*^9, 3.9290094906175537`*^9}, {
   3.9290117146807213`*^9, 3.9290117360746937`*^9}, {3.929013979575474*^9, 
   3.9290140000357647`*^9}, {3.9290156901548233`*^9, 3.929015690266693*^9}, {
   3.9290164878633327`*^9, 3.9290164879254246`*^9}, {3.9290237415531693`*^9, 
   3.929023741629013*^9}, {3.9290238427512455`*^9, 3.929023842830496*^9}, {
   3.9290241456549816`*^9, 3.9290241501077785`*^9}, {3.9290241941771717`*^9, 
   3.929024194313364*^9}},
 CellLabel->
  "In[1701]:=",ExpressionUUID->"ac86c335-bec0-c641-b6ab-828eb66af264"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Pentagonal", " ", "bipyramid", " ", "example"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"X", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ToExpression", "[", 
          RowBox[{"\"\<X\>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"i", " ", "+", " ", 
             RowBox[{"4", 
              RowBox[{"(", 
               RowBox[{"j", "-", "1"}], ")"}]}]}], "]"}]}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "1", ",", " ", "4"}], "}"}]}], "]"}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{"j", ",", " ", "1", ",", " ", "7"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetNonCommutative", "[", 
     RowBox[{"Flatten", "[", "X", "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PBVertices", " ", "=", " ", 
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", " ", "7"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fs", " ", "=", " ", 
     RowBox[{"{", "1", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hs", " ", "=", " ", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g", " ", "=", " ", 
     RowBox[{"-", "1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rules", " ", "=", " ", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PBEdges", " ", "=", " ", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AppendTo", "[", 
      RowBox[{"PBEdges", ",", " ", 
       RowBox[{"i", " ", "<->", " ", 
        RowBox[{"i", " ", "+", " ", "1"}]}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "4"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AppendTo", "[", 
     RowBox[{"PBEdges", ",", " ", 
      RowBox[{"5", " ", "<->", " ", "1"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"AppendTo", "[", 
       RowBox[{"PBEdges", ",", " ", 
        RowBox[{"6", " ", "<->", " ", "i"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"PBEdges", ",", " ", 
        RowBox[{"7", " ", "<->", " ", "i"}]}], "]"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "5"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PB", " ", "=", " ", 
     RowBox[{"Graph", "[", 
      RowBox[{"PBVertices", ",", " ", "PBEdges"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"adj", " ", "=", " ", 
     RowBox[{"AdjacencyMatrix", "[", "PB", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"adj", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], " ", "==", " ", 
            "1"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"hs", ",", " ", 
              RowBox[{
               RowBox[{"X", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", " ", "a"}], "]"}], "]"}], " ", "**", " ", 
               RowBox[{"X", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", " ", "a"}], "]"}], "]"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"i", " ", "<", " ", "j"}], ",", "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"rules", ",", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"X", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", " ", "a"}], "]"}], "]"}], " ", "**", 
                  " ", 
                  RowBox[{"X", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", " ", "a"}], "]"}], "]"}]}], " ", "->", 
                 " ", 
                 RowBox[{
                  RowBox[{"X", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", " ", "a"}], "]"}], "]"}], " ", "**", 
                  " ", 
                  RowBox[{"X", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", " ", "a"}], "]"}], "]"}]}]}]}], "]"}]}],
              "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
         ",", " ", 
         RowBox[{"{", 
          RowBox[{"j", ",", " ", "1", ",", " ", "7"}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "1", ",", " ", "7"}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"a", ",", " ", "1", ",", " ", "4"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"a", " ", "!=", " ", "b"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"hs", ",", " ", 
              RowBox[{
               RowBox[{"X", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", " ", "a"}], "]"}], "]"}], " ", "**", " ", 
               RowBox[{"X", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", " ", "b"}], "]"}], "]"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"a", " ", "<", " ", "b"}], ",", "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"rules", ",", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"X", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", " ", "b"}], "]"}], "]"}], " ", "**", 
                  " ", 
                  RowBox[{"X", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", " ", "a"}], "]"}], "]"}]}], " ", "->", 
                 " ", 
                 RowBox[{
                  RowBox[{"X", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", " ", "a"}], "]"}], "]"}], " ", "**", 
                  " ", 
                  RowBox[{"X", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", " ", "b"}], "]"}], "]"}]}]}]}], "]"}]}],
              "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
         ",", " ", 
         RowBox[{"{", 
          RowBox[{"b", ",", " ", "1", ",", " ", "4"}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"a", ",", " ", "1", ",", " ", "4"}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "7"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"hs", ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"X", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", " ", "a"}], "]"}], "]"}], " ", "**", " ", 
           RowBox[{"X", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", " ", "a"}], "]"}], "]"}]}], " ", "-", " ", 
          RowBox[{"X", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", " ", "a"}], "]"}], "]"}]}]}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"a", ",", " ", "1", ",", " ", "4"}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "7"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AppendTo", "[", 
      RowBox[{"hs", ",", " ", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"X", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", " ", "a"}], "]"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"a", ",", " ", "1", ",", " ", "4"}], "}"}]}], "]"}], " ", 
        "-", " ", "1"}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "7"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Length", "[", 
    RowBox[{"NCMonoidVec", "[", 
     RowBox[{"Xvar", ",", " ", "1", ",", " ", "rules"}], "]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.928949341516239*^9, 3.928949374585005*^9}, {
   3.9289508159189224`*^9, 3.928950828902937*^9}, {3.9289509060642376`*^9, 
   3.928951079687491*^9}, {3.928951306105936*^9, 3.928951317091629*^9}, {
   3.9289513814845448`*^9, 3.9289514024209805`*^9}, {3.928951459317528*^9, 
   3.928951473958273*^9}, {3.928951608965973*^9, 3.928951620696713*^9}, {
   3.928951668537482*^9, 3.928951759658993*^9}, 3.928951967757181*^9, {
   3.928954972286728*^9, 3.928954999648517*^9}, {3.9290246735646095`*^9, 
   3.9290249092291813`*^9}, {3.929025030276037*^9, 3.9290250327761707`*^9}, {
   3.929025148267214*^9, 3.929025163968195*^9}, {3.929025377339155*^9, 
   3.9290254270380344`*^9}, {3.929025603696581*^9, 3.9290256431901283`*^9}, {
   3.9290256967065945`*^9, 3.9290259022888813`*^9}, {3.929025936937744*^9, 
   3.929025995847975*^9}, {3.92902605992239*^9, 3.9290261934313526`*^9}},
 CellLabel->
  "In[1647]:=",ExpressionUUID->"b92a5cd0-1173-3549-b1f4-2c78a7160efb"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9290266802987976`*^9, 
  3.9290266803008175`*^9}},ExpressionUUID->"2211c24f-f313-ff49-a075-\
329a14713658"]
},
WindowSize->{1268, 720},
WindowMargins->{{0.5, Automatic}, {Automatic, 0.5}},
CellContext->Notebook,
Magnification:>1. Inherited,
FrontEndVersion->"14.0 for Microsoft Windows (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"637a3232-033e-5243-add0-6c9c8108a202"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 8156, 214, 1132, "Input",ExpressionUUID->"4e9251e3-0bbe-d34f-b4fe-7e4e33d24b2e"],
Cell[8739, 238, 511, 12, 21, "Message",ExpressionUUID->"aefb5b7f-7589-7647-b1f6-855eec67fbb4"]
}, Open  ]],
Cell[9265, 253, 6734, 154, 676, "Input",ExpressionUUID->"e81fc51d-b930-2648-aeca-eccee976689c"],
Cell[16002, 409, 826, 22, 68, "Input",ExpressionUUID->"84bad4b7-c680-5d4a-8d51-d3f1071768d5"],
Cell[16831, 433, 77612, 1783, 7228, "Input",ExpressionUUID->"d0c1367f-040d-5c42-87a1-3c6d53202cdd"],
Cell[94446, 2218, 154, 3, 28, "Input",ExpressionUUID->"8beb707d-0c52-5644-8d09-719fdfb067ed"],
Cell[94603, 2223, 7599, 167, 581, "Input",ExpressionUUID->"ac86c335-bec0-c641-b6ab-828eb66af264"],
Cell[102205, 2392, 10476, 256, 1285, "Input",ExpressionUUID->"b92a5cd0-1173-3549-b1f4-2c78a7160efb"],
Cell[112684, 2650, 156, 3, 28, "Input",ExpressionUUID->"2211c24f-f313-ff49-a075-329a14713658"]
}
]
*)

